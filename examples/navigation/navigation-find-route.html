<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Dabeeo Map</title>
    <!--    <script type="text/javascript" src="[다비오기술문서의 api 링크]"></script>-->
    <style>
        body {
            margin: 0;
        }
    </style>
</head>
<body>
<div id="map"></div>
</body>
<script>
    let mapContainer = document.getElementById('map'); // 지를 표시할 div

    // 지도 인증정보
    let authorization = new indoorMapApi.Authorization({
        clientId: "28AXw_veA2YbNKDP6poTpT",
        clientSecret: "70c540c169af62808f4da3709e988e06"
    });

    let mapOptions = {
        authorization: authorization,
        minZoom: 3, // 최소 줌 설정
        maxZoom: 8, // 최대 줌 설정,
        center: new indoorMapApi.Point({ // 지도의 중심좌표
            x: 3000,
            y: 1500
        })
    };

    // 지도를 표시할 div, 옵션으로 생성 후 로딩이 완료되면 콜백으로 결과를 리턴합니다
    new indoorMapApi.MapView(
        mapContainer, // 컨테이너
        mapOptions, // 옵션
        function (response) { // 맵 로드 콜백
            let code = response.getCode();

            if (code === 200) {
                let mapView = response.getPayload().mapView;

                let navigationOptions = new indoorMapApi.NavigationOptions({
                    mapView: mapView, // 네비게이션 할 맵
                    origin: new indoorMapApi.Location({ // 출발지
                        x: 2766.3703703703695,
                        y: 996.7407407407402,
                        floorLevel: 1
                    }),
                    destination: new indoorMapApi.Location({ // 도착지
                        x: 2532.6890752574263,
                        y: 1642.751826731636,
                        floorLevel: 1
                    }),
                    wayPoints: [new indoorMapApi.Location({ // 경유지
                        x: 3933.4814814814818,
                        y: 745.4814814814813,
                        floorLevel: 1
                    })]
                });

                let navigation = new indoorMapApi.Navigation(navigationOptions); // 네비게이션 객체 생성
                let routes = navigation.getRoutes(); // 경로 가져오기

                let points = [];
                routes.pathList.forEach(path => {
                    // 가져온 경로로 폴리라인 포인트 생성
                    points.push(new indoorMapApi.Point({
                        x: path.x,
                        y: path.y
                    }));
                });

                let polylineOptions = new indoorMapApi.PolylineOptions({
                    points: points
                });
                polylineOptions.setColor("#FFD78A"); // 선 색상
                polylineOptions.setWidth(7); // 선 굵기
                polylineOptions.setOpacity(0.5); // 투명도 설정

                let polyline = new indoorMapApi.Polyline(polylineOptions); // 폴리라인 생성
                polyline.addTo(mapView); // 지도에 폴리라인 추가﻿﻿
            }
        }
    );
</script>
</html>